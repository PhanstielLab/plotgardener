<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot a Manhattan plot — plotManhattan • plotgardener</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot a Manhattan plot — plotManhattan"><meta property="og:description" content="Plot a Manhattan plot"><meta property="og:image" content="https://phanstiellab.github.io/plotgardener/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plotgardener</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/guides/our_philosophy.html">Our Philosophy</a>
</li>
<li>
  <a href="../articles/introduction_to_plotgardener.html">Introduction to plotgardener</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/guides/plotgardener_page.html">The plotgardener Page</a>
    </li>
    <li>
      <a href="../articles/guides/reading_data_for_plotgardener.html">Reading Data for plotgardener</a>
    </li>
    <li>
      <a href="../articles/guides/plotting_multiomic_data.html">Plotting Multi-omic Data</a>
    </li>
    <li>
      <a href="../articles/guides/annotations.html">Plot Annotations</a>
    </li>
    <li>
      <a href="../articles/guides/plotgardener_meta_functions.html">plotgardener Meta Functions</a>
    </li>
    <li>
      <a href="../articles/guides/bioconductor_integration.html">Bioconductor Integration</a>
    </li>
    <li>
      <a href="../articles/guides/incorporating_ggplots.html">Incorporating ggplots and other grid-based Bioconductor visualizations</a>
    </li>
    <li>
      <a href="../articles/guides/ideograms_and_shapes.html">Ideograms and Shapes</a>
    </li>
    <li>
      <a href="../articles/guides/aesthetics.html">Plot Aesthetics</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PhanstielLab/plotgardener" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a Manhattan plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/PhanstielLab/plotgardener/blob/HEAD/R/plotManhattan.R" class="external-link"><code>R/plotManhattan.R</code></a></small>
    <div class="hidden name"><code>plotManhattan.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot a Manhattan plot</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotManhattan</span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    sigVal <span class="op">=</span> <span class="fl">5e-08</span>,</span>
<span>    chrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    chromstart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    chromend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>    cex <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    leadSNP <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    sigLine <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sigCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"-log10"</span>,</span>
<span>    range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    space <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    bg <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    baseline.color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    baseline.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span>
<span>    flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    default.units <span class="op">=</span> <span class="st">"inches"</span>,</span>
<span>    draw <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Data to be plotted, as a character value specifying a
file path of GWAS data, a dataframe, or a <a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a>
object. Each of these data types must have the following columns:</p><ul><li><p><code>"chrom"</code>: Chromosome names. This column must be a character.</p></li>
<li><p><code>"pos"</code>: Chromosomal position. This column must be
an integer or numeric.</p></li>
<li><p><code>"p"</code>: p-value or similar measure. This column must be numeric.
Values will be converted according to the <code>trans</code> parameter.</p></li>
<li><p><code>"snp"</code>(optional): SNP name or rsid.
This column should be a character.</p></li>
</ul></dd>


<dt>sigVal</dt>
<dd><p>A numeric specifying the significance level of p-values.
Along with data p-values, this value will be converted according to the
<code>trans</code> parameter.
Default value is <code>sigVal = 5e-08</code>.</p></dd>


<dt>chrom</dt>
<dd><p>Chromosome of region to be plotted, as a string.
If left <code>NULL</code>, all chromosomes found in data will be plotted.</p></dd>


<dt>chromstart</dt>
<dd><p>Integer start position on chromosome to be plotted.</p></dd>


<dt>chromend</dt>
<dd><p>Integer end position on chromosome to be plotted.</p></dd>


<dt>assembly</dt>
<dd><p>Default genome assembly as a string or a
<a href="assembly.html">assembly</a> object.
Default value is <code>assembly = "hg38"</code>.</p></dd>


<dt>fill</dt>
<dd><p>A single character value, a vector, or a 
<a href="colorby.html">colorby</a> object specifying fill colors of data points.
For a Manhattan plot with multiple chromosomes, a vector of colors 
will be used to color points of different chromosomes.
Default value is <code>fill = "black"</code>.</p></dd>


<dt>pch</dt>
<dd><p>A numeric value or numeric vector specifying point symbols.
If <a href="colorby.html">colorby</a> object is supplied for <code>fill</code>,
point symbols will be mapped to
<code>colorby</code> values. Default value is <code>pch = 19</code>.</p></dd>


<dt>cex</dt>
<dd><p>A numeric indicating the amount by which points should be
scaled relative to the default. Default value is <code>cex = 0.25</code>.</p></dd>


<dt>leadSNP</dt>
<dd><p>A list specifying the lead SNP in the desired region and
any associated aesthetic features of the lead SNP data point and text label.
The lead SNP should be specified as a character with the name slot
<code>"snp"</code> in the list. Accepted lead SNP aesthetic
features in the list include
<code>fill</code>, <code>pch</code>, <code>cex</code>, <code>fontcolor</code>, and <code>fontsize</code>.</p></dd>


<dt>sigLine</dt>
<dd><p>Logical value indicating whether to draw a line at the
significance level indicated with <code>sigVal</code>.
Default value is <code>sigLine = FALSE</code>.</p></dd>


<dt>sigCol</dt>
<dd><p>Single character value specifying the color of
significant data points.</p></dd>


<dt>trans</dt>
<dd><p>Character value specifying the transformation to apply to the
"p" column plotted along the y-axis. For no transformation, set value to the 
empty character "". Default value is <code>trans = "-log10"</code>.</p></dd>


<dt>range</dt>
<dd><p>A numeric vector of length 2 specifying the y-range
of p-values to plot (c(min, max)).</p></dd>


<dt>space</dt>
<dd><p>A numeric value indicating the space between each
chromosome as a fraction of the width of the plot, if plotting multiple
chromosomes. Default value is <code>space = 0.01</code>.</p></dd>


<dt>bg</dt>
<dd><p>Character value indicating background color.
Default value is <code>bg = NA</code>.</p></dd>


<dt>baseline</dt>
<dd><p>Logical value indicating whether to include a
baseline along the x-axis. Default value is <code>baseline = FALSE</code>.</p></dd>


<dt>baseline.color</dt>
<dd><p>Baseline color. Default value
is <code>baseline.color = "grey"</code>.</p></dd>


<dt>baseline.lwd</dt>
<dd><p>Baseline line width. Default value
is <code>baseline.lwd = 1</code>.</p></dd>


<dt>x</dt>
<dd><p>A numeric or unit object specifying Manhattan plot x-location.</p></dd>


<dt>y</dt>
<dd><p>A numeric, unit object, or character containing a "b"
combined with a numeric value specifying Manhattan plot y-location.
The character value will
place the Manhattan plot y relative to the bottom of the most
recently plotted plot according to the units of the plotgardener page.</p></dd>


<dt>width</dt>
<dd><p>A numeric or unit object specifying Manhattan plot width.</p></dd>


<dt>height</dt>
<dd><p>A numeric or unit object specifying Manhattan plot height.</p></dd>


<dt>just</dt>
<dd><p>Justification of Manhattan plot relative to its (x, y)
location. If there are two values, the first value specifies horizontal
justification and the second value specifies vertical justification.
Possible string values are: <code>"left"</code>, <code>"right"</code>,
<code>"centre"</code>, <code>"center"</code>, <code>"bottom"</code>, and <code>"top"</code>.
Default value is <code>just = c("left", "top")</code>.</p></dd>


<dt>flip</dt>
<dd><p>Logical value indicating whether to reflect Manhattan plot
over the x-axis. Default value is <code>flip = FALSE</code>.</p></dd>


<dt>default.units</dt>
<dd><p>A string indicating the default units to use
if <code>x</code>, <code>y</code>, <code>width</code>, or <code>height</code> are only given
as numerics. Default value is <code>default.units = "inches"</code>.</p></dd>


<dt>draw</dt>
<dd><p>A logical value indicating whether graphics output should
be produced. Default value is <code>draw = TRUE</code>.</p></dd>


<dt>params</dt>
<dd><p>An optional <a href="pgParams.html">pgParams</a> object containing
relevant function parameters.</p></dd>


<dt>...</dt>
<dd><p>Additional grid graphical parameters. See <a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a <code>manhattan</code> object containing
relevant genomic region, placement, and <a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a> information.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A Manhattan plot can be placed on a plotgardener coordinate page by
providing plot placement parameters:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/plotManhattan.html">plotManhattan</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                chrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                chromstart <span class="op">=</span> <span class="cn">NULL</span>, chromend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                <span class="va">x</span>, <span class="va">y</span>, <span class="va">width</span>, <span class="va">height</span>, just <span class="op">=</span> <span class="fu"><a href="../reference/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span>
<span>                default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></span></code></pre></div><p>This function can also be used to quickly plot an unannotated
Manhattan plot by ignoring plot placement parameters:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/plotManhattan.html">plotManhattan</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                chrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                chromstart <span class="op">=</span> <span class="cn">NULL</span>, chromend <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load genomic assembly information</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Load GWAS data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PhanstielLab/plotgardenerData" class="external-link">plotgardenerData</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hg19_insulin_GWAS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a page</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pageCreate.html">pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">4.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot all GWAS data</span></span></span>
<span class="r-in"><span><span class="va">manhattanPlot</span> <span class="op">&lt;-</span> <span class="fu">plotManhattan</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hg19_insulin_GWAS</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"#37a7db"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sigLine <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    trans <span class="op">=</span> <span class="st">"-log10"</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">"grey"</span>, lty <span class="op">=</span> <span class="fl">2</span>, range <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">6.5</span>, height <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> manhattan[manhattan1]</span>
<span class="r-in"><span><span class="co">## Annotate genome label</span></span></span>
<span class="r-in"><span><span class="fu"><a href="annoGenomeLabel.html">annoGenomeLabel</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    plot <span class="op">=</span> <span class="va">manhattanPlot</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2</span>, fontsize <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>    just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> genomeLabel[genomeLabel1]</span>
<span class="r-in"><span><span class="fu"><a href="plotText.html">plotText</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    label <span class="op">=</span> <span class="st">"Chromosome"</span>, fontsize <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fl">3.75</span>, y <span class="op">=</span> <span class="fl">2.20</span>, just <span class="op">=</span> <span class="st">"center"</span>, default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> text[text1]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Annotate y-axis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="annoYaxis.html">annoYaxis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    plot <span class="op">=</span> <span class="va">manhattanPlot</span>, at <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    axisLine <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> yaxis[yaxis1]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot y-axis label</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotText.html">plotText</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    label <span class="op">=</span> <span class="st">"-log10(p-value)"</span>, x <span class="op">=</span> <span class="fl">0.15</span>, y <span class="op">=</span> <span class="fl">1</span>, rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    fontsize <span class="op">=</span> <span class="fl">8</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, just <span class="op">=</span> <span class="st">"center"</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> text[text2]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot GWAS data zooming in on chromosome 11</span></span></span>
<span class="r-in"><span><span class="co">## highlighting a lead SNP, and coloring by LD score</span></span></span>
<span class="r-in"><span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">LD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">LD</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Group LD column into LD ranges</span></span></span>
<span class="r-in"><span><span class="va">hg19_insulin_GWAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span>,</span></span>
<span class="r-in"><span>                                        LDgrp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                                        <span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">LD</span>,</span></span>
<span class="r-in"><span>                                        <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">LDgrp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">addNA</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">LDgrp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">leadSNP_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span><span class="op">[</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">chrom</span> <span class="op">==</span> <span class="st">"chr11"</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">leadSNP</span> <span class="op">&lt;-</span> <span class="va">hg19_insulin_GWAS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">hg19_insulin_GWAS</span><span class="op">$</span><span class="va">p</span> <span class="op">==</span> <span class="va">leadSNP_p</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">snp</span></span></span>
<span class="r-in"><span><span class="va">chr11_manhattanPlot</span> <span class="op">&lt;-</span> <span class="fu">plotManhattan</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hg19_insulin_GWAS</span>, chrom <span class="op">=</span> <span class="st">"chr11"</span>,</span></span>
<span class="r-in"><span>    chromstart <span class="op">=</span> <span class="fl">60000000</span>,</span></span>
<span class="r-in"><span>    chromend <span class="op">=</span> <span class="fl">130000000</span>,</span></span>
<span class="r-in"><span>    assembly <span class="op">=</span> <span class="st">"hg19"</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="fu"><a href="colorby.html">colorby</a></span><span class="op">(</span><span class="st">"LDgrp"</span>,</span></span>
<span class="r-in"><span>    palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="c.html">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"#1f4297"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"#37a7db"</span>, <span class="st">"green"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"grey"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    trans <span class="op">=</span> <span class="st">"-log10"</span>,</span></span>
<span class="r-in"><span>    sigLine <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>    lty <span class="op">=</span> <span class="fl">2</span>, range <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    leadSNP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        snp <span class="op">=</span> <span class="va">leadSNP</span>,</span></span>
<span class="r-in"><span>        pch <span class="op">=</span> <span class="fl">18</span>,</span></span>
<span class="r-in"><span>        cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="st">"#7ecdbb"</span>,</span></span>
<span class="r-in"><span>        fontsize <span class="op">=</span> <span class="fl">8</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.5</span>, width <span class="op">=</span> <span class="fl">6.5</span>,</span></span>
<span class="r-in"><span>    height <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> manhattan[manhattan2]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot legend for LD scores</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotLegend.html">plotLegend</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"LD Ref Var"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"0.4"</span>, <span class="st">"&gt;"</span>, <span class="st">"r^2"</span>, </span></span>
<span class="r-in"><span>        <span class="st">""</span>, <span class="st">"&gt;="</span>, <span class="st">"0.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"0.2"</span>, <span class="st">"&gt;"</span>, <span class="st">"r^2"</span>, </span></span>
<span class="r-in"><span>        <span class="st">""</span>, <span class="st">"&gt;="</span>, <span class="st">"0"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="st">"no LD data"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"#7ecdbb"</span>, <span class="st">"#37a7db"</span>, <span class="st">"#1f4297"</span>, <span class="st">"grey"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">FALSE</span>, x <span class="op">=</span> <span class="fl">7</span>, y <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>    width <span class="op">=</span> <span class="fl">1.5</span>, height <span class="op">=</span> <span class="fl">0.6</span>, just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> legend[legend1]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Annotate genome label</span></span></span>
<span class="r-in"><span><span class="fu"><a href="annoGenomeLabel.html">annoGenomeLabel</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    plot <span class="op">=</span> <span class="va">chr11_manhattanPlot</span>, x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">4.01</span>,</span></span>
<span class="r-in"><span>    fontsize <span class="op">=</span> <span class="fl">8</span>, scale <span class="op">=</span> <span class="st">"Mb"</span>,</span></span>
<span class="r-in"><span>    just <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> genomeLabel[genomeLabel2]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Annotate y-axis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="annoYaxis.html">annoYaxis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    plot <span class="op">=</span> <span class="va">chr11_manhattanPlot</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    axisLine <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> yaxis[yaxis2]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot y-axis label</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotText.html">plotText</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    label <span class="op">=</span> <span class="st">"-log10(p-value)"</span>, x <span class="op">=</span> <span class="fl">0.15</span>, y <span class="op">=</span> <span class="fl">3.25</span>, rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    fontsize <span class="op">=</span> <span class="fl">8</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, just <span class="op">=</span> <span class="st">"center"</span>,</span></span>
<span class="r-in"><span>    default.units <span class="op">=</span> <span class="st">"inches"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> text[text2]</span>
<span class="r-plt img"><img src="plotManhattan-1.png" alt="" width="1230" height="1050"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Hide page guides</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pageGuideHide.html">pageGuideHide</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotManhattan-2.png" alt="" width="1230" height="1050"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/nekramer" class="external-link">Nicole Kramer</a>, <a href="https://github.com/EricSDavis" class="external-link">Eric S. Davis</a>, <a href="https://github.com/cwenger" class="external-link">Craig Wenger</a>, <a href="https://github.com/dphansti" class="external-link">Douglas H. Phanstiel</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

