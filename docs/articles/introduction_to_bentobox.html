<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to BentoBox • BentoBox</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BentoBox">
<meta property="og:description" content="BentoBox">
<meta property="og:image" content="https://phanstiellab.github.io/bentobox/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BentoBox</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/our_philosophy.html">Our Philosophy</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_to_bentobox.html">Introduction to BentoBox</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PhanstielLab/BentoBox">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_to_bentobox_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to BentoBox</h1>
                        <h4 class="author">Nicole Kramer, Eric S. Davis, Craig Wenger, Sarah Parker, Erika Deoudes, and Douglas H. Phanstiel</h4>
            
            <h4 class="date">2021-04-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PhanstielLab/BentoBox/blob/master/vignettes/introduction_to_bentobox.Rmd"><code>vignettes/introduction_to_bentobox.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_to_bentobox.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><img src="../man/figures/logo.png" align="right" width="140px" style="padding-left:20px; background-color:white; border-color: transparent"></p>
<p><code>BentoBox</code> is a coordinate-based, genomic visualization package for R. Using <code>grid</code> graphics, <code>BentoBox</code> empowers users to programatically and flexibly generate multi-panel figures. Tailored for genomics, <code>BentoBox</code> allows users to visualize large, complex genomic datasets while providing exquisite control over the arrangement of plots.</p>
<p><code>BentoBox</code> functions can be grouped into the following categories:</p>
<ul>
<li>
<p><strong>Page layout functions:</strong></p>
<p>Functions for creating <code>BentoBox</code> page layouts, drawing, showing, and hiding guides, as well as placing plots on the page.</p>
</li>
<li>
<p><strong>Reading functions:</strong></p>
<p>Functions for quickly reading in large biological datasets.</p>
</li>
<li>
<p><strong>Plotting functions:</strong></p>
<p>Contains genomic plotting functions, functions for placing ggplots and base plots, as well as functions for drawing simple shapes.</p>
</li>
<li>
<p><strong>Annotation functions:</strong></p>
<p>Enables users to add annotations to their plots, such as legends, axes, and scales.</p>
</li>
<li>
<p><strong>Meta functions:</strong></p>
<p>Functions that display <code>BentoBox</code> properties, or operate on other <code>BentoBox</code> functions.</p>
</li>
</ul>
<p>This vignette provides a best-practices guide for utilizing <code>BentoBox</code>. It begins with a Quick Start section that outlines usage examples for reading in and plotting the most commonly used genomic data. Then the following sections explore how BentoBox works in more detail, highlighting helpful topics that showcase the capabilities of BentoBox. For detailed usage of each function, see the function-specific reference examples with <code>?function()</code> (e.g. <code>?bb_plotBedpe()</code>).</p>
</div>
<div id="quick-start" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h1>
<div id="how-to-quickly-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-quickly-plot" class="anchor"></a>How to quickly plot</h2>
<p><code>BentoBox</code> plotting functions contain 4 types of arguments:</p>
<ol style="list-style-type: decimal">
<li><p>Data reading argument (<code>data</code>)</p></li>
<li><p>Locus arguments (<code>chrom</code>, <code>chromstart</code>, <code>chromend</code>, <code>assembly</code>)</p></li>
<li><p>Placement arguments (<code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>, …) that define where each plot resides on a <code>bb_page</code>.</p></li>
<li><p>Attribute arguments that affect the data being plotted or the style of the plot (<code>palette</code>, <code>norm</code>, <code>fontcolor</code>, …). These are typically different for each function.</p></li>
</ol>
<p>The quickest way to plot data is to omit the placement arguments. This will generate a <code>BentoBox</code> plot that fills up the entire graphics window. The only arguments that are required are the data arguments and locus arguments. The examples below show how to quickly plot different types of genomic data with plot defaults and included data types. To use your own data, replace the <code>data</code> argument with either a path to the file or an R object.</p>
<div id="hi-c-matricies" class="section level3">
<h3 class="hasAnchor">
<a href="#hi-c-matricies" class="anchor"></a>Hi-C matricies</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example Hi-C data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="co">## Quick plot Hi-C data</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/hic_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="signal-tracks" class="section level3">
<h3 class="hasAnchor">
<a href="#signal-tracks" class="anchor"></a>Signal tracks</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example signal data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>

<span class="co">## Quick plot signal data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/signal_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="gene-tracks" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-tracks" class="anchor"></a>Gene tracks</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load hg19 genomic annotation packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'BiocGenerics' was built under R version 4.0.5</span>
<span class="co">#&gt; Warning: package 'GenomeInfoDb' was built under R version 4.0.5</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>

<span class="co">## Quick plot genes</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>assembly <span class="op">=</span> <span class="st">"hg19"</span>,
             chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gene_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
<p>Alternatively, if you want to plot around a particular gene rather than a genomic region you can specify <code>gene</code> and <code>geneBuffer</code> using the <code><a href="../reference/bb_params.html">bb_params()</a></code> meta function. If <code>geneBuffer</code> is not included, the default buffer adds <code>(gene length) / 2</code> base pairs to the ends of the gene coordinates.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load hg19 genomic annotation packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>

<span class="co">## Quick plot genes</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>params <span class="op">=</span> <span class="fu"><a href="../reference/bb_params.html">bb_params</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="st">"IL1B"</span>, geneBuffer <span class="op">=</span> <span class="fl">1000</span>, assembly <span class="op">=</span> <span class="st">"hg19"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gene2_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div id="gwas-manhattan-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#gwas-manhattan-plots" class="anchor"></a>GWAS manhattan plots</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example gwas data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bb_gwasData</span><span class="op">)</span>
<span class="co">#&gt;    chr       pos         p        snp   LD</span>
<span class="co">#&gt; 1 chr1  34294726 0.6835307 rs10914788 &lt;NA&gt;</span>
<span class="co">#&gt; 2 chr1 236591003 0.9930270   rs634626 &lt;NA&gt;</span>
<span class="co">#&gt; 3 chr1 193391538 0.7216855 rs12043960 &lt;NA&gt;</span>
<span class="co">#&gt; 4 chr1   7554435 0.1002769  rs1725271 &lt;NA&gt;</span>
<span class="co">#&gt; 5 chr1  82022757 0.9852280 rs12090221 &lt;NA&gt;</span>
<span class="co">#&gt; 6 chr1  10246129 0.4317934  rs2180185 &lt;NA&gt;</span>

<span class="co">## Quick plot gwas data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/gwas_quickplot-1.png" width="288" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="how-to-add-plot-annotations" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-add-plot-annotations" class="anchor"></a>How to add plot annotations</h2>
<p>To add annotation features to a <code>bb_plot</code> object, or to view multiple <code>bb_plot</code> objects simultaneously, we must:</p>
<ol style="list-style-type: decimal">
<li>Create a BentoBox coordinate page with <code><a href="../reference/bb_pageCreate.html">bb_pageCreate()</a></code>.</li>
<li>Provide a <code>bb_plot</code> object to the <code>plot</code> argument (for annotation).</li>
<li>Provide values for the placement arguments (<code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>) in <code>bb_plot</code> functions.</li>
</ol>
<p>As an annotation example, here we add a color scale and genome label annotation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example Hi-C data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot Hi-C data with placing information</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Add color scale annotation</span>
<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                     x <span class="op">=</span> <span class="fl">2.85</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">1.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Add genome label annotation</span>
<span class="fu"><a href="../reference/bb_annoGenomeLabel.html">bb_annoGenomeLabel</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                   x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">2.75</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">0.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_quickplot-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## Hide plot gridlines</span>
<span class="fu"><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/anno_quickplot-2.png" width="384" style="display: block; margin: auto;"></p>
<p>For more information about how to place plots and annotations on a <code>bb_page</code> check out the section <code>Arranging bb_plot Objects</code>.</p>
</div>
</div>
<div id="the-bentobox-page" class="section level1">
<h1 class="hasAnchor">
<a href="#the-bentobox-page" class="anchor"></a>The <code>BentoBox</code> page</h1>
<p><code>BentoBox</code> uses a coordinate-based plotting system to define the size and location of plots. This system makes the plotting process intuitive and absolute, meaning that plots cannot be squished and stretched based on their <em>relative</em> sizes. This also allows for precise control of the size of each visualization and the location of all plots, annotations, and text.</p>
<p>All <code>BentoBox</code> page functions begin with the <code>bb_page</code> prefix.</p>
<p>Users can create a page in their preferred size and unit of measurement using <code><a href="../reference/bb_pageCreate.html">bb_pageCreate()</a></code>. Within this function the user can also set gridlines in the vertical and horizontal directions with <code>xgrid</code> and <code>ygrid</code>, respectively. By default these values are set to 0.5 of the unit. In the following example we demonstrate creating a standard 8.5 x 11 inch page:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8.5</span>, height <span class="op">=</span> <span class="fl">11</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo01-1.png" width="1056" style="display: block; margin: auto;"></p>
<p>Or we could create a smaller sized page in a different set of units with different gridlines:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">8</span>, xgrid <span class="op">=</span> <span class="fl">1</span>, ygrid <span class="op">=</span> <span class="fl">1</span>, default.units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo02-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We could turn off gridlines entirely by setting <code>xgrid</code> and <code>ygrid</code> to 0:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, xgrid <span class="op">=</span> <span class="fl">0</span>, ygrid <span class="op">=</span> <span class="fl">0</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo03-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also remove all guidelines from the plot once we are finished by using the <code><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide()</a></code> function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo04-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Remove guides</span>
<span class="fu"><a href="../reference/bb_pageGuideHide.html">bb_pageGuideHide</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/page_demo04-2.png" width="480" style="display: block; margin: auto;"></p>
<div id="arranging-plot-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#arranging-plot-objects" class="anchor"></a>Arranging plot objects</h2>
<p>In <code>BentoBox</code> all plot objects are boxes, with user defined positions and sizes. All plot objects can be placed on a <code>bb_page</code> using the placement arguments (e.g. <code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>, <code>just</code>, <code>default.units</code>, …). The <code>bb_page</code> sets the origin of the plot at the top left corner of the page. By default, the <code>x</code> and <code>y</code> arguments place the top-left corner of a plot in the specified position on the <code>bb_page</code> while the <code>width</code> and <code>height</code> arguments define the size of the plot.</p>
<p>For example, if users want the top-left corner of their plot to be 0.5 inches down from the top of the page and 0.5 inches from the left…</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example01-1.png" width="480" style="display: block; margin: auto;"></p>
<p>and the plot to be 2 inches wide and 1 inch tall…</p>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example02-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code>BentoBox</code> can make the plot with these exact dimensions:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot rectangle</span>
<span class="fu"><a href="../reference/bb_plotRect.html">bb_plotRect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>,
            just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example03-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code>BentoBox</code> also provides the helper function <code><a href="../reference/bb_pagePlotPlace.html">bb_pagePlotPlace()</a></code> for placing plot objects that have been previously defined:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>

<span class="co">## Create page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">3</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Define signal plot</span>
<span class="va">signalPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co">## Place plot on bb_page</span>
<span class="fu"><a href="../reference/bb_pagePlotPlace.html">bb_pagePlotPlace</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">signalPlot</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">1</span>, 
                 just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example04-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This gives the users additional flexibility in how they create their R scripts.</p>
</div>
<div id="using-the-just-parameter" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-just-parameter" class="anchor"></a>Using the <code>just</code> parameter</h2>
<p>While the <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code> parameters are relative to the top-left corner of the plot by default, the <code>just</code> parameter provides additional flexibility by allowing users to change the reference point. The <code>just</code> parameter accepts a character or numeric vector of length 2 describing the horizontal and vertical justification (or reference point), respectively.</p>
<p>The just parameter can be set using character strings “left”, “right”, “center”, “bottom” and “top”:</p>
<pre><code>#&gt; Warning in if (grepl("b", bb_hguide$y) == TRUE) {: the condition has length &gt; 1
#&gt; and only the first element will be used</code></pre>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example05-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Or it can be set using numeric values where 0 means left/bottom, 1 means right/top, and 0.5 means center:</p>
<pre><code>#&gt; Warning in if (grepl("b", bb_hguide$y) == TRUE) {: the condition has length &gt; 1
#&gt; and only the first element will be used</code></pre>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example06-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This is particularly useful when an object needs to be aligned in reference to another plot object or page marker. For example, in the Hi-C plot below we might want to align the top-right corner of the heatmap legend to the 3 inch mark. There is no need to calculate the top-left position (i.e. <code>3 inches - (legend width)</code>) to determine where to place the heatmap legend. Instead we can change the <code>just</code> parameter to <code>just=c('right', 'top')</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example Hi-C data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3.25</span>, height <span class="op">=</span> <span class="fl">3.25</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot Hi-C data with placing information</span>
<span class="va">hicPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                            chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                            x <span class="op">=</span> <span class="fl">0.25</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">2.5</span>, height <span class="op">=</span> <span class="fl">2.5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Add color scale annotation with just = c("right", "top")</span>
<span class="fu"><a href="../reference/bb_annoHeatmapLegend.html">bb_annoHeatmapLegend</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">hicPlot</span>,
                     x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">0.25</span>, width <span class="op">=</span> <span class="fl">0.1</span>, height <span class="op">=</span> <span class="fl">1.25</span>,
                     just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/arrange_example07-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="plotting-multi-omic-data" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-multi-omic-data" class="anchor"></a>Plotting multi-omic data</h1>
<p><code>BentoBox</code> makes it easy to create reproducible, publication-quality figures from multi-omic data. Since each plot can be placed in <em>exactly</em> the desired location, users can stack multiple types of genomic data so that their axes and data are correctly aligned. In this section we will show some examples of plotting multi-omic data, how the <code>bb_params</code> object can facilitate this process, and how to correctly normalize stacked signal track data.</p>
<p>In the following example, we plot the same genomic region (i.e. <code>chr21:28000000-30300000</code>) represented in Hi-C data, loop annotations, signal track data, GWAS data, all along a common gene track and genome label axis:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Load BentoBox</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://phanstiellab.github.io/bentobox">BentoBox</a></span><span class="op">)</span>

<span class="co">## Load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrHicData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_bedpeData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_imrH3K27acData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bb_gwasData"</span><span class="op">)</span>

<span class="co">## Create a BentoBox page</span>
<span class="fu"><a href="../reference/bb_pageCreate.html">bb_pageCreate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">5</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot Hi-C data in region</span>
<span class="fu"><a href="../reference/bb_plotHicSquare.html">bb_plotHicSquare</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrHicData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">2</span>,
                 just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot loop annotations</span>
<span class="fu"><a href="../reference/bb_plotBedpeArches.html">bb_plotBedpeArches</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_bedpeData</span>,
                   chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                   x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.25</span>, 
                   just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span>,
                   fill <span class="op">=</span> <span class="st">"black"</span>, linecolor <span class="op">=</span> <span class="st">"black"</span>, position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>

<span class="co">## Plot signal track data</span>
<span class="fu"><a href="../reference/bb_plotSignal.html">bb_plotSignal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_imrH3K27acData</span>,
              chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
              x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">2.75</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>, 
              just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot GWAS data </span>
<span class="fu"><a href="../reference/bb_plotManhattan.html">bb_plotManhattan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bb_gwasData</span>,
                 chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                 ymax <span class="op">=</span> <span class="fl">1.1</span>, cex <span class="op">=</span> <span class="fl">0.20</span>,
                 x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">3.5</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>,
                 just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot gene track</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TxDb.Hsapiens.UCSC.hg19.knownGene</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>
<span class="fu"><a href="../reference/bb_plotGenes.html">bb_plotGenes</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
             x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">4</span>, width <span class="op">=</span> <span class="fl">2</span>, height <span class="op">=</span> <span class="fl">0.5</span>,
             just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span>

<span class="co">## Plot genome label</span>
<span class="fu"><a href="../reference/bb_plotGenomeLabel.html">bb_plotGenomeLabel</a></span><span class="op">(</span>chrom <span class="op">=</span> <span class="st">"chr21"</span>, chromstart <span class="op">=</span> <span class="fl">28000000</span>, chromend <span class="op">=</span> <span class="fl">30300000</span>,
                   x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">4.5</span>, length <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="st">"Mb"</span>,
                   just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, default.units <span class="op">=</span> <span class="st">"inches"</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_bentobox_files/figure-html/plotting_example01-1.png" width="480" style="display: block; margin: auto;"></p>
<div id="using-the-bb_params-object" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-bb_params-object" class="anchor"></a>Using the <code>bb_params</code> object</h2>
<p>The <code><a href="../reference/bb_params.html">bb_params()</a></code> function creates a <code>bb_params</code> object that can contain any argument from <code>BentoBox</code> functions.</p>
<p>We can recreate and simplify the multi-omic plot above</p>
</div>
<div id="stacked-signal-tracks" class="section level2">
<h2 class="hasAnchor">
<a href="#stacked-signal-tracks" class="anchor"></a>Stacked signal tracks</h2>
<p>Coming soon…</p>
</div>
</div>
<div id="plot-aesthetics" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-aesthetics" class="anchor"></a>Plot aesthetics</h1>
<p>Coming soon…</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/nekramer">Nicole Kramer</a>, <a href="https://github.com/EricSDavis">Eric S. Davis</a>, <a href="https://github.com/cwenger">Craig Wenger</a>, <a href="https://github.com/dphansti">Douglas H. Phanstiel</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
